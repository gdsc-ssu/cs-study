# π™‹β€β™€οΈπ™‹β€β™‚οΈ μΈν„°λ½νΈ(Interrupt)

## πΈ μΈν„°λ½νΈ(Interrupt)λ€?

- μΈν„°λ½νΈλ” `μ»΄ν“¨ν„°κµ¬μ΅°` λ° `OS`μ—μ„ μ •λ§ λ§μ΄ λ‚μ¤λ” ν‚¤μ›λ“μ΄λ‹¤.
- CPUκ°€ ν”„λ΅κ·Έλ¨μ„ μ‹¤ν–‰ν•κ³  μμ„ λ•, **μ…μ¶λ ¥** ν•λ“μ›¨μ–΄ λ“±μ μ¥μΉλ‚ **μμ™Έ μƒν™©**μ΄ λ°μƒν•μ—¬ μ²λ¦¬κ°€ ν•„μ”ν•  κ²½μ°μ— `λ§μ΄ν¬λ΅ν”„λ΅μ„Έμ„(micro processor)`μ—κ² μ•λ ¤ μ²λ¦¬ν•  μ μλ„λ΅ ν•λ” κ²ƒ
  - κ°€λ Ή κµμκ°€ κ°•μλ¥Ό ν•λ λ„μ¤‘ ν• ν•™μƒμ΄ μ§λ¬Έμ„ ν–κ³ , κµμλ” ν•™μƒμ μ§λ¬Έμ— λ‹µλ³€μ„ ν• ν›„ κ°•μλ¥Ό μ΄μ–΄λ‚κ°„λ‹¤κ³  ν•μ.
  - μ΄λ•, ν•™μƒμ΄ μ§λ¬Έμ„ ν• ν–‰μ„λ¥Ό `μΈν„°λ½νΈ(Interrupt)`λΌκ³  ν•  μ μλ‹¤.
    - κµμκ°€ κ°•μλ¥Ό μ§„ν–‰ -> CPUκ°€ ν”„λ΅κ·Έλ¨μ„ μ‹¤ν–‰
    - ν•™μƒμ΄ μ§λ¬Έ -> μμ™Έ μƒν™© λ°μƒ μ „λ‹¬ : `μΈν„°λ½νΈ(Interrupt)`
    - κµμκ°€ μ§λ¬Έμ— λ‹µλ³€ ν›„ λ‹¤μ‹ κ°•μ -> CPUκ°€ μ²λ¦¬ ν›„ λ‹¤μ‹ ν”„λ΅κ·Έλ¨ μ‹¤ν–‰

### β“ μΈν„°λ½νΈ(Interrupt)λ¥Ό μ‚¬μ©ν•λ” μ΄μ 

- μ…μ¶λ ¥ μ—°μ‚°μ κ²½μ°, CPU λ…λ Ή μν–‰μ†λ„μ— λΉ„ν•΄ ν„μ €ν λλ¦¬λ‹¤.
- λ•λ¬Έμ— CPUλ¥Ό ν¨μ¨μ μΌλ΅ μ‚¬μ©ν•κΈ° μ„ν•΄ μ‚¬μ©ν•λ‹¤.

## πΈ μΈν„°λ½νΈ(Interrupt)μ μΆ…λ¥

### πΎ μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈ (λ‚΄λ¶€ μΈν„°λ½νΈ)

- μ†ν”„νΈμ›¨μ–΄κ°€ λ°μƒμ‹ν‚¤λ” μΈν„°λ½νΈ
- μ†ν”„νΈμ›¨μ–΄κ°€ `μΈν„°λ½νΈ λΌμΈ`μ„ μ„Έν…ν•μ—¬, μΈν„°λ½νΈλ¥Ό λ°μƒμ‹ν‚¨λ‹¤.
  - ν”„λ΅κ·Έλ¨ μ¤λ¥
    - μ‹¤ν–‰ν•  μ μ—†λ” λ…λ Ήμ–΄
    - λ…λ Ήμ–΄ μ‹¤ν–‰ μ¤λ¥
  - System Call νΈμ¶
  - μ‚¬μ© κ¶ν• μ„λ°°
    - μ‚¬μ©μκ°€ μ΄μμ²΄μ λ§ μ‚¬μ©ν•  μ μλ” μμ›μ— μ ‘κ·Όν•  κ²½μ°μ—
  - ν•λ“μ›¨μ–΄ κ³ μ¥
    - μ»΄ν“¨ν„° κ³ μ¥
    - λ°μ΄ν„° μ „λ‹¬ κ³Όμ •μ—μ„μ λΉ„νΈ μ¤λ¥
    - μ „μ› Out
      > ν•λ“μ›¨μ–΄ κ³ μ¥μ€ μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈμ΄λ‹¤.

### πΎ ν•λ“μ›¨μ–΄ μΈν„°λ½νΈ (μ™Έλ¶€ μΈν„°λ½νΈ)

- ν•λ“μ›¨μ–΄κ°€ λ°μƒμ‹ν‚¤λ” μΈν„°λ½νΈ
- CPUκ°€ μ•„λ‹ λ‹¤λ¥Έ μ¥μΉκ°€ CPUμ—κ² μ–΄λ–¤ μ‚¬μ‹¤μ„ μ•λ ¤μ£Όκ±°λ‚ CPU μ„λΉ„μ¤λ¥Ό μ”μ²­ν•λ” κ²½μ°μ— λ°μƒλλ‹¤.
- μ£Όλ΅ `μ…μ¶λ ¥ μ¥μΉ`μ— μν•΄ λ°μƒλλ‹¤.
  - νƒ€μ΄λ¨Έ μΈν„°λ½νΈ
    - νƒ€μ΄λ¨Έκ°€ μΌμ •ν• μ‹κ°„ κ°„κ²©μΌλ΅ μ¤‘μ•™μ²λ¦¬μ¥μΉμ—κ² μΈν„°λ½νΈλ¥Ό μ”μ²­
  - μ…μ¶λ ¥ μΈν„°λ½νΈ
    - μ†λ„κ°€ λλ¦° μ…μ¶λ ¥μ¥μΉκ°€ μ…μ¶λ ¥ μ¤€λΉ„κ°€ μ™„λ£λμ—μμ„ μ•λ¦¬κΈ° μ„ν•΄ μΈν„°λ½νΈλ¥Ό μ”μ²­

## πΈ μΈν„°λ½νΈ(Interrupt) μ²λ¦¬ κ³Όμ •

### πΎ μ©μ–΄ μ •λ¦¬

- **μΈν„°λ½νΈ ν•Έλ“¤λ¬ (μΈν„°λ½νΈ μ„λΉ„μ¤ λ£¨ν‹΄)**
  - λ£¨ν‹΄μ΄λ€, λ°λ³µμ μΌλ΅ μν–‰ν•λ” μΌμ„ μλ―Έν•¨.
  - μΈν„°λ½νΈ μ²λ¦¬κ³Όμ •μ—μ„ μ–΄λ–¤ μ†μ¤(Source)κ°€ μΈν„°λ½νΈ μ”μ²­μ„ ν•  λ•, λ°λ³µμ μΌλ΅ μν–‰ν•΄μ•Ό ν•λ” μΌ.
    - μ†μ¤λ§λ‹¤ μ²λ¦¬λ¥Ό μ”μ²­ν•λ” μΌμ΄ λ‹¤λ¥΄κΈ° λ•λ¬Έμ—, μ„λ΅ λ‹¤λ¥Έ λ£¨ν‹΄λ“¤μ€ κΈ°μ–µμ¥μΉμ— μ €μ¥λμ–΄μλ‹¤.
    - μ¦‰ `μΈν„°λ½νΈ μ„λΉ„μ¤ λ£¨ν‹΄` μ—­μ‹ ν”„λ΅κ·Έλ¨μ μΌμΆ…μ΄λ‹¤.
- **μΈν„°λ½νΈ λ²΅ν„°**
  - μ„μ—μ„ μ–ΈκΈ‰ν• μΈν„°λ½νΈ μ„λΉ„μ¤ λ£¨ν‹΄μ μ£Όμ†λ¥Ό λ³΄κ΄€ν•κ³  μλ” ν…μ΄λΈ”μ΄λ‹¤.
- **PCB(Process Control Block)**
  - μΈν„°λ½νΈ λ°μƒ μ‹, ν”„λ΅μ„Έμ¤μ μ–΄λ λ¶€λ¶„μ΄ μν–‰ μ¤‘μ΄μ—λ”μ§€ μ €μ¥λμ–΄μλ” λΈ”λ΅.
    - μν–‰ μ¤‘μ΄λ memory μ£Όμ†
    - λ μ§€μ¤ν„° κ°’
    - ν•λ“μ›¨μ–΄ μƒνƒ
  - μ»¤λ„μ λ°μ΄ν„° μμ—­μ— μ΅΄μ¬ν•¨.

### πΎ μ²λ¦¬ κ³Όμ •

![image](https://i.imgur.com/MD4NrLz.png)

- λ…λ Ήμ–΄ μ‚¬μ΄ν΄μ€ `μΈμ¶(fetch stage)`μ™€ `μ‹¤ν–‰(execution stage)` λ‘ κ°€μ§€ λ‹¨κ³„λ¥Ό λ°λ³µν•΄μ„ μν–‰
- μΈν„°λ½νΈ μ”μ²­μ΄ λ“¤μ–΄μ™”μ„ λ• λ°”λ΅ μ²λ¦¬ν•λ” κ²ƒ X
  1. λ…λ Ήμ–΄ Nμ μ‹¤ν–‰ λ‹¨κ³„λ¥Ό λ§μ³μ•Όν•¨
  2. λ…λ Ήμ–΄ μ‹¤ν–‰ λ‹¨κ³„λ¥Ό λ§μΉ  λ• λ§λ‹¤, μ¤‘μ•™μ²λ¦¬μ¥μΉλ” λ°λ³µμ μΌλ΅ μΈν„°λ½νΈ μ”μ²­μ΄ μλ”μ§€ κ³„μ†ν•΄μ„ ν™•μΈ
  3. μΈν„°λ½νΈ μ”μ²­μ΄ μμ–΄μ•Ό μΈν„°λ½νΈ μ„λΉ„μ¤ λ‹¨κ³„λ¥Ό μ§„ν–‰

<br/>![image](https://i.imgur.com/sA0vHHB.png)

1. process Aλ” system callμ„ ν†µν•΄ μΈν„°λ½νΈλ¥Ό λ°μƒμ‹ν‚¨λ‹¤.
2. CPUλ” ν„μ¬ μ§„ν–‰ μ¤‘μΈ κΈ°κ³„μ–΄ μ½”λ“λ¥Ό μ™„λ£ν•λ‹¤.
3. ν„μ¬κΉμ§€ μν–‰μ¤‘μ΄μ—λ μƒνƒλ¥Ό ν•΄λ‹Ή processμ `PCB(Process Control Block)`μ— μ €μ¥ν•λ‹¤.
4. PC(Program Counter, IP)μ— λ‹¤μμ— μ‹¤ν–‰ν•  λ…λ Ήμ μ£Όμ†λ¥Ό μ €μ¥ν•λ‹¤.
5. μΈν„°λ½νΈ λ²΅ν„°λ¥Ό μ½κ³  ISR μ£Όμ†κ°’μ„ μ–»μ–΄ `ISR(Interrupt Service Routine)`λ΅ μ ν”„ν•μ—¬ λ£¨ν‹΄μ„ μ‹¤ν–‰ν•λ‹¤.
6. ν•΄λ‹Ή μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ‹¤.
7. ν•΄λ‹Ή μΌμ„ λ‹¤ μ²λ¦¬ν•λ©΄, λ€ν”Όμ‹ν‚¨ λ μ§€μ¤ν„°λ¥Ό λ³µμ›ν•λ‹¤.
8. ISRμ λμ— IRET λ…λ Ήμ–΄μ— μν•΄ μΈν„°λ½νΈκ°€ ν•΄μ  λλ‹¤.
9. IRET λ…λ Ήμ–΄κ°€ μ‹¤ν–‰λλ©΄, λ€ν”Όμ‹ν‚¨ PC κ°’μ„ λ³µμ›ν•μ—¬ μ΄μ „ μ‹¤ν–‰ μ„μΉλ΅ λ³µμ›ν•λ‹¤.

## πΈ μΈν„°λ½νΈμ™€ λ…λ Ή

### πΎ λ…λ Ήμ–΄

- **μΌλ° λ…λ Ή**
  - λ¨λ“  ν”„λ΅κ·Έλ¨μ΄ μν–‰κ°€λ¥ν• λ…λ Ή
    - λ©”λ¨λ¦¬μ—μ„ μλ£ μ½κΈ°
    - CPUμ—μ„ κ³„μ‚°ν•κΈ°
- **νΉκ¶ λ…λ Ή**
  - λ³΄μ•μ΄ ν•„μ”ν• λ…λ Ή. μ΄μμ²΄μ λ§μ΄ μν–‰ κ°€λ¥.
    - μ…μ¶λ ¥ μ¥μΉ μ ‘κ·Ό
    - νƒ€μ΄λ¨Έ μ¥μΉ μ ‘κ·Ό
- **Kernel Mode**
  - μ΄μμ²΄μ κ°€ CPU μ μ–΄κ¶μ„ κ°–κ³  λ…λ Ήμ–΄λ¥Ό μν–‰ν•λ” λ¨λ“
  - `μΌλ° λ…λ Ή`κ³Ό `νΉκ¶ λ…λ Ή` λ¨λ‘ κ°€λ¥
- **User Mode**
  - μΌλ° μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ΄ CPU μ μ–΄κ¶μ„ κ°–κ³  λ…λ Ήμ„ μν–‰ν•λ” λ¨λ“
  - `μΌλ° λ…λ Ή`λ§ μν–‰ κ°€λ¥

### πΎ μ‹μ¤ν… μ½ (System Call)

- `User Mode`μ—μ„ μ΄μμ²΄μ μ μ„λΉ„μ¤λ¥Ό λ°›κΈ° μ„ν•΄ μ»¤λ„ ν•¨μλ¥Ό νΈμ¶ν•λ” κ²ƒ
- μ μ–΄κ¶μ΄ μ΄μμ²΄μ μ—λ΅ λ„μ–΄κ°

### πΎ I/O

- I/O λ…λ Ήμ€ νΉκ¶ λ…λ Ήμ΄κΈ° λ•λ¬Έμ— μ‚¬μ©μ λ¨λ“ ν”„λ΅κ·Έλ¨μ—μ„λ” I/Oλ…λ Ήμ„ μ²λ¦¬ν•μ§€ λ»ν•¨.
- κ·Έλμ„ μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ€ μ»¤λ„ ν•¨μλ¥Ό νΈμ¶ν•λ” system callμ„ μ΄μ©ν•¨.
  1. μ‚¬μ©μ ν”„λ΅κ·Έλ¨μ΄ μ΄μμ²΄μ μ—κ² μ‹μ¤ν… μ½μ„ ν•λ‹¤.
  2. μ†ν”„νΈμ›¨μ–΄ μΈν„°λ½νΈλ¥Ό ν†µν•΄ μΈν„°λ½νΈ λ²΅ν„°μ μ„μΉλ΅ μ΄λ™ν•λ‹¤.
  3. μ μ–΄κ¶μ΄ μΈν„°λ½νΈ λ²΅ν„°κ°€ κ°€λ¥΄ν‚¤λ” μΈν„°λ½νΈ μ„λΉ„μ¤ λ£¨ν‹΄μΌλ΅ μ΄λ™ν•λ‹¤.
  4. μ¬λ°”λ¥Έ I/O μ‘μ—…μΈμ§€ ν™•μΈ ν›„, μ‹¤μ  I/Oλ¥Ό μν–‰ν•λ‹¤.

## π” μ°Έκ³ μλ£

### λ‚΄μ© λ° μ΄λ―Έμ§€ μ°Έκ³ 

- [[μ»΄ν“¨ν„°κµ¬μ΅°] μΈν„°λ½νΈ(Interrupt)λ€?](https://whatisthenext.tistory.com/147)
- [[OSκΈ°μ΄] μΈν„°λ½νΈ μ λ€λ΅ μ΄ν•΄ν•κΈ°](https://velog.io/@adam2/%EC%9D%B8%ED%84%B0%EB%9F%BD%ED%8A%B8)
- [CS-Free-study/CS-Study - Interrupt.md](https://github.com/CS-Free-study/CS-Study/blob/main/contents/operating-system/Interrupt.md)
