# Blocking&NonBlocking

### 📂 단어정리

- 제어권: 함수의 코드를 실행할 권리 같은 것. 제어권을 가진 함수는 자신의 코드를 끝까지 실행한 후, 자신을 호출한 함수에게 돌려준다.
- 결과값을 기다린다는 것: A함수에서 B함수를 호출했을 때, A함수가 B함수의 결과값을 기다리느냐의 여부를 의미.

## 동기&비동기

- 동기와 비동기는 프로세스의 수행순서 보장에 대한 메커니즘이다.
- 처리할 작업들을 어떠한 **흐름**으로 처리할 것인가에 대한 관점이다.
- 함수의 작업 완료여부를 신경쓰냐에 따라 함수 실행/리턴 순차적인 흐름을 따르느냐, 안따르느냐에 관심사를 둔다.

### 동기

- 요청자가 요청받은 함수의 작업이 완료되었는지 계속 확인한다.
- 여러 함수들이 시간을 맞춰 실행된다.
- 함수 A가 함수 B의 작업 완료 후 리턴을 기다리거나, 바로 리턴 받더라도 미완료 상태이면 작업 완료 여부를 스스로 계속 확인하며 신경쓰면 동기(Synchronous)이다.

### 비동기

- 요청자는 요청후 일을 신경 쓰지 않는다. 요청받은 함수가 작업을 마치면 알려준다.
- 그렇기에 함수들의 작업 시작/종료 시간이 맞지 않을 수도 있다.
- 함수 A가 함수 B를 호출할 때 콜백 함수를 함께 전달해서 함수 B의 작업이 완료되면 함께 보낸 콜백함수를 실행한다.
- 함수 A는 함수 B를 호출한 후 함수 B의 작업 완료 여부에는 신경쓰지 않는다.(Aysnchronous)

## 블로킹&논블록킹

- 블로킹과 논블록킹은 프로세스의 유휴 상태에 대한 개념이다.
- 처리되어야 하는 하나의 작업이 **전체적인 작업 흐름을 막느냐, 안막느냐**에 대한 관점이다.
- 제어권이 누구한테 있느냐에 관심사를 둔다.

### 블로킹

![블로킹.png](https://user-images.githubusercontent.com/85864699/209420084-2696d330-8c41-4306-90a4-4c4e6269f893.png)

- 요청받은 함수가 작업을 모두 마치고 나서야 요청자에게 제어권을 넘겨준다.(그동안 요청자는 아무것도 하지않고 기다린다)
- A함수가 B함수를 호출하면 **제어권을 A가 호출한 B함수에 넘겨준다.**
- 순서
    1. A함수가 B함수를 호출하면 B에게 제어권을 넘긴다.
    2. 제어권을 넘겨받은 B는 함수를 실행하고, A는 B에게 제어권을 넘겨주었기에 **함수실행을 잠시 멈춘다.**
    3. B함수는 실행이 끝나면 자신을 호출한 A에게 제어권을 돌려준다.

### 논블록킹

![논블로킹.png](https://user-images.githubusercontent.com/85864699/209420094-1b23f997-673e-4bf6-baa6-b064baa2777a.png)

- 요청받은 함수가 요청자에게 제어권을 바로 넘겨준다(그동안 요청자는 다른 일을 할 수 있다)
- A함수가 B함수를 호출해도 **제어권은 그대로 자신이 가지고 있는다.**
- 순서
    1. A함수가 B함수를 호출하면, B함수는 실행되지만, 제어권은 A함수가 그대로 가지고 있는다.
    2. A함수는 계속 제어권을 가지고 있기에 B함수를 호출한 이후에도 **자신의 코드를 계속 실행한다.**

## 동기&비동기 + 블로킹&논블로킹 조합

|  | Blocking | NonBlocking |
| --- | --- | --- |
| Synchronous | Sync-Blocking | Sync-NonBlocking |
| Asynchronous | Async-Blocking | Async-NonBlocking |

### Sync-Blocking

- 함수 A는 함수 B의 리턴값을 필요로 한다. (동기)
- 제어권을 함수 B에 넘겨주고, 함수 B가 실행을 완료하여 리턴값과 제어권을 돌려줄때 까지 기다린다.(블로킹)
- 예시
    - C나 JAVA 코드 실행 후 커맨드에서 입력받기
    
    ```
    A:"이 일 부탁해요."
    B:"넵"
    A: A가 일을 끝날때까지 기다림
    B:"끝냈습니다~!"
    A:"네넹~"
    ```
    

Async-Blocking

- A함수는 B함수를 호출한다.
- A함수는 B함수에게 제어권을 주지 않고, 자신의 코드를 계속 실행한다. (논 블로킹)
- A함수는 B함수의 리턴값이 필요하기 때문에 중간중간 B함수에게 함수 실행을 완료했는지 물어본다. (동기)
- 예시
    - 게임에서 데이터 로드율 표시
        
        ```
        A:"B씨, 이 일좀 부탁해요"
        B:"네네!"
        A:(할 거 하다가) "다 했어요?"
        B:"아뇨! 하는중이에요"
        A:(할 거 하다가) "다 했어요?"
        B:"네네!"
        ```
        

Async-NonBlocking

- A함수는 B함수를 호출한다.
- 제어권을 B함수에 주지않고, 자신이 계속 가지고 있는다. 따라서 B함수를 호출한 이후에도 멈추지 않고 자신의 코드를 계속 실행한다. (논블로킹)
- B함수를 호출할때 콜백함수를 함께 준다. B함수는 자신의 작업이 끝나면 A함수가 준 콜백함수를 실행한다.
- 예시
    - AJAX 요청, JS 비동기 콜백
    
    ```
    A:"B씨 이 일좀 부탁해요!"
    B: "네~ 다 하고 말씀 드릴게요!"
    A: 할거 하는 중
    B: "다 했습니당~~!"
    ```
    

### Async-Blocking

- A함수는 B함수의 리턴값에 신경쓰지 않고, 콜백함수를 보낸다. (비동기)
- 그런데 B함수의 작업에 관심 없음에도 불구하고 A함수는 B함수에게 제어권을 넘긴다. (블로킹)
- A함수는 자신과 관련이 없는 B함수의 작업이 끝날 때까지 기다려야 한다.
- 잘 마주하기 쉽지 않은 경우이다.
- 예시
    - NodeJS + MySQL 조합 ⇒ NodeJS에서 비동기적으로 DB 작업을 수행하더라도 블로킹 방식으로 작동하는 MySQL 드라이버를 거치게 된다.

## 참고자료

[https://inpa.tistory.com/entry/👩‍💻-동기비동기-블로킹논블로킹-개념-정리](https://inpa.tistory.com/entry/%F0%9F%91%A9%E2%80%8D%F0%9F%92%BB-%EB%8F%99%EA%B8%B0%EB%B9%84%EB%8F%99%EA%B8%B0-%EB%B8%94%EB%A1%9C%ED%82%B9%EB%85%BC%EB%B8%94%EB%A1%9C%ED%82%B9-%EA%B0%9C%EB%85%90-%EC%A0%95%EB%A6%AC)
